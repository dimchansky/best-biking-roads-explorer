<!-- index.html -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Best Biking Roads Map</title>
    <!-- Viewport Meta Tag for Responsive Design -->
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"
          integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm"
          crossorigin="anonymous">
    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
          integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
          crossorigin="" />
    <!-- noUiSlider CSS -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/noUiSlider/15.6.1/nouislider.min.css" rel="stylesheet">
    <!-- Custom CSS -->
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
<div id="app">
    <!-- Filter Section -->
    <nav class="filter-section bg-dark py-2">
        <div class="row w-100 m-0 align-items-center">
            <!-- Header -->
            <div class="col-md-2">
                <h5 class="text-white m-0">Best Biking Routes</h5>
            </div>
            <!-- Country Filter -->
            <div class="col-md-2 filter-group">
                <label class="text-white">Filter by Country</label>
                <button class="btn btn-sm btn-primary w-100" @click="openModal('country')">Select Country</button>
            </div>
            <!-- Road Type Filter -->
            <div class="col-md-2 filter-group">
                <label class="text-white">Filter by Road Type</label>
                <button class="btn btn-sm btn-primary w-100" @click="openModal('roadType')">Select Road Type</button>
            </div>
            <!-- Rating Filter -->
            <div class="col-md-2 filter-group">
                <label class="text-white">Filter by Rating</label>
                <button class="btn btn-sm btn-primary w-100" @click="openModal('rating')">Select Rating</button>
            </div>
            <!-- Export Button -->
            <div class="col-md-2">
                <button class="btn btn-success w-100" @click="exportToGPX">Export to GPX</button>
            </div>
        </div>
    </nav>
    <!-- Map Section -->
    <div class="map-container" id="map"></div>

    <!-- Filter Modal -->
    <div :class="['modal-overlay', { visible: showModal }]" @click.self="closeModal">
        <div class="modal-content">
            <div class="modal-header">
                <h5>{{ getModalTitle }}</h5>
                <button @click="closeModal" aria-label="Close Modal" class="close-button">&times;</button>
            </div>
            <div class="modal-body">
                <!-- Rating Filter with noUiSlider -->
                <div v-if="modalType === 'rating'">
                    <div id="rating-slider"></div>
                    <div class="slider-labels">
                        <span>Min: {{ tempRatingRange[0].toFixed(1) }}</span>
                        <span>Max: {{ tempRatingRange[1].toFixed(1) }}</span>
                    </div>
                </div>
                <!-- Other Filters with Checkboxes -->
                <div v-else>
                    <div class="search-bar mb-3">
                        <input type="text" v-model="searchQuery" :placeholder="'Search ' + getModalTitle" class="form-control" />
                    </div>
                    <div class="filter-options" style="max-height: 300px; overflow-y: auto;">
                        <div v-for="option in filteredModalOptions" :key="option" class="form-check">
                            <input
                                    type="checkbox"
                                    :id="option"
                                    :value="option"
                                    v-model="tempSelectedValues"
                                    class="form-check-input"
                            />
                            <label :for="option" class="form-check-label">{{ option }}</label>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-actions">
                <!-- Conditional Rendering of Buttons -->
                <template v-if="modalType === 'rating'">
                    <button
                            class="btn btn-secondary"
                            @click="resetRatingRange"
                    >
                        Reset Range
                    </button>
                </template>
                <template v-else>
                    <button
                            class="btn btn-secondary"
                            @click="selectAllModalSelection"
                    >
                        Select All
                    </button>
                    <button
                            class="btn btn-warning"
                            @click="clearModalSelection"
                    >
                        Clear
                    </button>
                </template>
                <button class="btn btn-primary" @click="applyModalSelection">Apply</button>
            </div>
        </div>
    </div>
</div>

<!-- jQuery first, then Popper.js, then Bootstrap JS -->
<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"
        integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
        crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js"
        integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
        crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js"
        integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
        crossorigin="anonymous"></script>
<!-- Leaflet JS -->
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
        integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
        crossorigin=""></script>
<!-- Polyline Decoding Library -->
<script src="https://unpkg.com/@mapbox/polyline@1.2.1/src/polyline.js"></script>
<!-- Vue.js -->
<script src="https://unpkg.com/vue@3/dist/vue.global.prod.js"></script>
<!-- noUiSlider JS -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/noUiSlider/15.6.1/nouislider.min.js"></script>
<!-- Constants JS -->
<script src="js/constants.js"></script>
<!-- GPX Export JS -->
<script src="js/gpxExport.js"></script>
<!-- Main Vue App -->
<script src="js/app.js"></script>
</body>
</html>